/**
 * Gets a list of cas (configurable attributes) and generates
 * edges between the product and cas and between attributes and sub attributes
 */
var _ = require("lodash");

module.exports = function (options) {
  var graph = options.graph,
    config = options.config,
    productVertex = _.defaults({
      id: config.id, // including it first explicitly to conform with the
                     // positioning convention that allows us to hash more efficiently
                     // and remove duplicated
      ns: "p"
    }, _.omit(config,
    _.keys(options.structure)
  ));


  graph.vertices.push(productVertex);

  // We need to pass the new graph in order to compose
  // this function with other steps.
  options.graph = graph;
  return options;
};
