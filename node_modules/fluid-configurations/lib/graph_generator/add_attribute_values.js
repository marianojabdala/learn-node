/**
 * Gets a list of avs (configurable attributes) and generates
 * edges between the product and avs and between attributes and sub attributes
 */
var _ = require("lodash"),
  relationshipTypes = [
    "upcharge",
    "pricingDescription",
    "facets",
    "valueUsages"
  ];

function addAttributeValueVertices(options) {
  var config = options.config,
    getIdAsInt = options.utils.getIdAsInt;

  _.each(config.values || {}, function (av, id) {
    id = getIdAsInt(id);

    var vertex = _.defaults({
      id: id,
      ns: "av"
    }, _.omit(av, relationshipTypes));
    options.graph.vertices.push(vertex);
  });
}

module.exports = function (options) {
  addAttributeValueVertices(options);
  return options;
};
