/**
 * Given an admin published configuration, this module
 * outputs an object with multiple graphs
 * under result.optimizedGraph you can find the main
 * graph used on configure.
 * result.graph includes a raw version of the graph
 * that might include duplicated vertices and edges
 * result.graph can also include a .issues property
 * explaining the problems we encountered while
 * generating the graph.
 *
 * Example:
 *
 *    var graphGenerator = require("./index");
 *    graphGenerator(config);
 */

var _ = require("lodash"),
  steps = _.pluck(require("./steps"), "fn");

steps.unshift(function (config) {
  return { config: JSON.parse(JSON.stringify(config)) };
});

// Exposes all graph generation steps
module.exports = _.compose.apply(null, steps.reverse());
