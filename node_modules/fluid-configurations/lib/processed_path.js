/**
 * Generates a function for retrieving the
 * path for a processed s3Object
 */
var path = require("path"),
  version = process.env.PROCESSED_VERSION || require("../package").version;

module.exports = function (options) {

  return function (local_dir, s3Object) {
    return path.normalize(local_dir + "/" +
        (
          process.env.SKIP_PROCESSED_VERSION_PATHS ? "" : version + "/"
        ) +
        s3Object.environment + "/" +
        s3Object.workflow + "/" +
        s3Object.customerId + "/" +
        (
          options.type ?
            "/" + options.type + "/" + s3Object[options.typeKey] :
            ""
        )
      );
  };
};
