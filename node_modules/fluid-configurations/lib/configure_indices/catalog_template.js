/**
 * Gets the templates available for a catalog.
 *
 * Example:
 *    var params = {
 *      "environment": "prod",
 *      "customerId": 1475,
 *      "workflow": "prod",
 *      "catalogId": 7
 *    };
 *    getCatalogTemplate(params, function (err, templates) {
 *      if (err) {
 *        return console.log(err, err.stack);
 *      }
 *      console.log(JSON.stringify(templates, null, 2));
 *    });
 *
 * Outputs:
 *
 *     [
 *       {
 *         "Key": "prod/prod/customers/c1443/configureHtml/galleries/templates/gallery_3_EN.js",
 *         "LastModified": "2012-07-23T23:58:21.000Z",
 *         "ETag": "92f623745e651ef0f6fb18ce72b42625",
 *         "Size": 1090,
 *         "locale": "EN",
 *         "environment": "prod",
 *         "workflow": "prod",
 *         "customerId": 1443,
 *         "catalogId": 3
 *       }
 *     ]
 */
var listLocalizedObjects = require("../s3").listLocalizedObjects,
  _ = require("lodash"),
  default_options = {
    type: "catalogTemplate",
    replaceSuffix: "_(.+)"
  };

module.exports = function (options, callback) {
  listLocalizedObjects(
    _.defaults({}, options, default_options), {
      Prefix: options.environment + "/" +
        options.workflow + "/customers/c" +
        options.customerId +
        "/configureHtml/galleries/templates/gallery_" +
        options.catalogId
    },
    callback
  );
};
